Script started on 2023-07-22 14:11:25+03:00 [TERM="tmux-256color" TTY="/dev/pts/2" COLUMNS="180" LINES="69"]
[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ ls -l
[?2004l–∏—Ç–æ–≥–æ 8
-rw-rw-r-- 1 zoid zoid  422 –∏—é–ª 22 12:46 README.md
-rw-rw-r-- 1 zoid zoid    0 –∏—é–ª 22 14:11 script.log
-rw-rw-r-- 1 zoid zoid    0 –∏—é–ª 22 14:11 timing.log
-rw-rw-r-- 1 zoid zoid 1654 –∏—é–ª 22 13:15 Vagrantfile
[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ v[Kcat Vagrantfile 
[?2004l[38;5;238m‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[0m[m
       [38;5;238m‚îÇ [0mFile: [1mVagrantfile[0m[m
[38;5;238m‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[0m[m
[38;5;238m   1[0m   [38;5;238m‚îÇ[0m [38;2;117;113;94m#[0m[38;2;117;113;94m -*- mode: ruby -*-[0m[m
[38;5;238m   2[0m   [38;5;238m‚îÇ[0m [38;2;117;113;94m#[0m[38;2;117;113;94m vim: set ft=ruby :[0m[m
[38;5;238m   3[0m   [38;5;238m‚îÇ[0m [m
[38;5;238m   4[0m   [38;5;238m‚îÇ[0m [38;2;117;113;94m#[0m[38;2;117;113;94m –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –í–ú[0m[m
[38;5;238m   5[0m   [38;5;238m‚îÇ[0m [38;2;166;226;46mMACHINES[0m[38;2;248;248;242m [0m[38;2;249;38;114m=[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m[m
[38;5;238m   6[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m  [0m[38;2;117;113;94m#[0m[38;2;117;113;94m –ò–º—è DV "pam"[0m[m
[38;5;238m   7[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m  [0m[38;2;190;132;255m:"[0m[38;2;190;132;255mpam[0m[38;2;190;132;255m"[0m[38;2;248;248;242m [0m[38;2;248;248;242m=>[0m[38;2;248;248;242m [0m[38;2;248;248;242m{[0m[m
[38;5;238m   8[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m              [0m[38;2;117;113;94m#[0m[38;2;117;113;94m VM box[0m[m
[38;5;238m   9[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m              [0m[38;2;246;240;128m:[0m[38;2;246;240;128mbox_name[0m[38;2;248;248;242m [0m[38;2;248;248;242m=>[0m[38;2;248;248;242m [0m[38;2;249;38;114m"[0m[38;2;230;219;116mgeneric/centos8s[0m[38;2;249;38;114m"[0m[38;2;248;248;242m,[0m[m
[38;5;238m  10[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m              [0m[38;2;117;113;94m#[0m[38;2;117;113;94mbox_version[0m[m
[38;5;238m  11[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m              [0m[38;2;246;240;128m:[0m[38;2;246;240;128mbox_version[0m[38;2;248;248;242m [0m[38;2;248;248;242m=>[0m[38;2;248;248;242m [0m[38;2;249;38;114m"[0m[38;2;230;219;116m4.2.16[0m[38;2;249;38;114m"[0m[38;2;248;248;242m,[0m[m
[38;5;238m  12[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m              [0m[38;2;117;113;94m#[0m[38;2;117;113;94m –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä CPU[0m[m
[38;5;238m  13[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m              [0m[38;2;246;240;128m:[0m[38;2;246;240;128mcpus[0m[38;2;248;248;242m [0m[38;2;248;248;242m=>[0m[38;2;248;248;242m [0m[38;2;190;132;255m2[0m[38;2;248;248;242m,[0m[m
[38;5;238m  14[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m              [0m[38;2;117;113;94m#[0m[38;2;117;113;94m –£–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –û–ó–£ (–í –ú–µ–≥–∞–±–∞–π—Ç–∞—Ö)[0m[m
[38;5;238m  15[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m              [0m[38;2;246;240;128m:[0m[38;2;246;240;128mmemory[0m[38;2;248;248;242m [0m[38;2;248;248;242m=>[0m[38;2;248;248;242m [0m[38;2;190;132;255m1024[0m[38;2;248;248;242m,[0m[m
[38;5;238m  16[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m              [0m[38;2;117;113;94m#[0m[38;2;117;113;94m –£–∫–∞–∑—ã–≤–∞–µ–º IP-–∞–¥—Ä–µ—Å –¥–ª—è –í–ú[0m[m
[38;5;238m  17[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m              [0m[38;2;246;240;128m:[0m[38;2;246;240;128mip[0m[38;2;248;248;242m [0m[38;2;248;248;242m=>[0m[38;2;248;248;242m [0m[38;2;249;38;114m"[0m[38;2;230;219;116m192.168.59.10[0m[38;2;249;38;114m"[0m[38;2;248;248;242m,[0m[m
[38;5;238m  18[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m            [0m[38;2;248;248;242m}[0m[m
[38;5;238m  19[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m}[0m[m
[38;5;238m  20[0m   [38;5;238m‚îÇ[0m [m
[38;5;238m  21[0m   [38;5;238m‚îÇ[0m [38;2;102;217;239mVagrant[0m[38;2;248;248;242m.[0m[38;2;248;248;242mconfigure[0m[38;2;255;255;255m([0m[38;2;249;38;114m"[0m[38;2;230;219;116m2[0m[38;2;249;38;114m"[0m[38;2;255;255;255m)[0m[38;2;248;248;242m [0m[38;2;249;38;114mdo[0m[38;2;248;248;242m [0m[38;2;248;248;242m|[0m[38;2;253;151;31mconfig[0m[38;2;248;248;242m|[0m[m
[38;5;238m  22[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m  [0m[38;2;102;217;239mMACHINES[0m[38;2;248;248;242m.[0m[38;2;248;248;242meach [0m[38;2;249;38;114mdo[0m[38;2;248;248;242m [0m[38;2;248;248;242m|[0m[38;2;253;151;31mboxname[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;253;151;31mboxconfig[0m[38;2;248;248;242m|[0m[m
[38;5;238m  23[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m    [0m[38;2;117;113;94m#[0m[38;2;117;113;94m –û—Ç–∫–ª—é—á–∞–µ–º —Å–µ—Ç–µ–≤—É—é –ø–∞–ø–∫—É[0m[m
[38;5;238m  24[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m    config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mvm[0m[38;2;248;248;242m.[0m[38;2;248;248;242msynced_folder [0m[38;2;249;38;114m"[0m[38;2;230;219;116m.[0m[38;2;249;38;114m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;249;38;114m"[0m[38;2;230;219;116m/vagrant[0m[38;2;249;38;114m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;246;240;128mdisabled[0m[38;2;246;240;128m:[0m[38;2;248;248;242m [0m[38;2;174;129;255mtrue[0m[m
[38;5;238m  25[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m    [0m[38;2;117;113;94m#[0m[38;2;117;113;94m –î–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å[0m[m
[38;5;238m  26[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m    config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mvm[0m[38;2;248;248;242m.[0m[38;2;248;248;242mnetwork [0m[38;2;249;38;114m"[0m[38;2;230;219;116mprivate_network[0m[38;2;249;38;114m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;246;240;128mip[0m[38;2;246;240;128m:[0m[38;2;248;248;242m boxconfig[0m[38;2;248;248;242m[[0m[38;2;246;240;128m:[0m[38;2;246;240;128mip[0m[38;2;248;248;242m][0m[m
[38;5;238m  27[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m    [0m[38;2;117;113;94m#[0m[38;2;117;113;94m –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤—ã—à–µ[0m[m
[38;5;238m  28[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m    config[0m[38;2;248;248;242m.[0m[38;2;248;248;242mvm[0m[38;2;248;248;242m.[0m[38;2;248;248;242mdefine boxname [0m[38;2;249;38;114mdo[0m[38;2;248;248;242m [0m[38;2;248;248;242m|[0m[38;2;253;151;31mbox[0m[38;2;248;248;242m|[0m[m
[38;5;238m  29[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m      box[0m[38;2;248;248;242m.[0m[38;2;248;248;242mvm[0m[38;2;248;248;242m.[0m[38;2;248;248;242mbox [0m[38;2;249;38;114m=[0m[38;2;248;248;242m boxconfig[0m[38;2;248;248;242m[[0m[38;2;246;240;128m:[0m[38;2;246;240;128mbox_name[0m[38;2;248;248;242m][0m[m
[38;5;238m  30[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m      box[0m[38;2;248;248;242m.[0m[38;2;248;248;242mvm[0m[38;2;248;248;242m.[0m[38;2;248;248;242mbox_version [0m[38;2;249;38;114m=[0m[38;2;248;248;242m boxconfig[0m[38;2;248;248;242m[[0m[38;2;246;240;128m:[0m[38;2;246;240;128mbox_version[0m[38;2;248;248;242m][0m[m
[38;5;238m  31[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m      box[0m[38;2;248;248;242m.[0m[38;2;248;248;242mvm[0m[38;2;248;248;242m.[0m[38;2;248;248;242mhost_name [0m[38;2;249;38;114m=[0m[38;2;248;248;242m boxname[0m[38;2;248;248;242m.[0m[38;2;102;217;239mto_s[0m[m
[38;5;238m  32[0m   [38;5;238m‚îÇ[0m [m
[38;5;238m  33[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m      box[0m[38;2;248;248;242m.[0m[38;2;248;248;242mvm[0m[38;2;248;248;242m.[0m[38;2;248;248;242mprovider [0m[38;2;249;38;114m"[0m[38;2;230;219;116mvirtualbox[0m[38;2;249;38;114m"[0m[38;2;248;248;242m [0m[38;2;249;38;114mdo[0m[38;2;248;248;242m [0m[38;2;248;248;242m|[0m[38;2;253;151;31mv[0m[38;2;248;248;242m|[0m[m
[38;5;238m  34[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m        v[0m[38;2;248;248;242m.[0m[38;2;248;248;242mmemory [0m[38;2;249;38;114m=[0m[38;2;248;248;242m boxconfig[0m[38;2;248;248;242m[[0m[38;2;246;240;128m:[0m[38;2;246;240;128mmemory[0m[38;2;248;248;242m][0m[m
[38;5;238m  35[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m        v[0m[38;2;248;248;242m.[0m[38;2;248;248;242mcpus [0m[38;2;249;38;114m=[0m[38;2;248;248;242m boxconfig[0m[38;2;248;248;242m[[0m[38;2;246;240;128m:[0m[38;2;246;240;128mcpus[0m[38;2;248;248;242m][0m[m
[38;5;238m  36[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m      [0m[38;2;249;38;114mend[0m[m
[38;5;238m  37[0m   [38;5;238m‚îÇ[0m [38;2;248;248;242m      box[0m[38;2;248;248;242m.[0m[38;2;248;248;242mvm[0m[38;2;248;248;242m.[0m[38;2;248;248;242mprovision [0m[38;2;249;38;114m"[0m[38;2;230;219;116mshell[0m[38;2;249;38;114m"[0m[38;2;248;248;242m,[0m[38;2;248;248;242m [0m[38;2;246;240;128minline[0m[38;2;246;240;128m:[0m[38;2;248;248;242m [0m[38;2;249;38;114m<<-SH[0m[38;2;248;248;242mELL[0m[m
[38;5;238m  38[0m   [38;5;238m‚îÇ[0m [38;2;255;255;255m          [0m[38;2;255;255;255m#–†–∞–∑—Ä–µ—à–∞–µ–º[0m[38;2;255;255;255m –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ SSH —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ä–æ–ª—è[0m[m
[38;5;238m  39[0m   [38;5;238m‚îÇ[0m [38;2;255;255;255m          [0m[38;2;255;255;255msed[0m[38;2;253;151;31m -[0m[38;2;253;151;31mi[0m[38;2;255;255;255m [0m[38;2;255;255;255m'[0m[38;2;230;219;116ms/^PasswordAuthentication.*$/PasswordAuthentication yes/[0m[38;2;255;255;255m'[0m[38;2;255;255;255m /etc/ssh/sshd_config[0m[m
[38;5;238m  40[0m   [38;5;238m‚îÇ[0m [38;2;255;255;255m          [0m[38;2;255;255;255m#–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫[0m[38;2;255;255;255m —Å–ª—É–∂–±—ã SSHD[0m[m
[38;5;238m  41[0m   [38;5;238m‚îÇ[0m [38;2;255;255;255m          [0m[38;2;255;255;255msystemctl[0m[38;2;255;255;255m restart sshd.service[0m[m
[38;5;238m  42[0m   [38;5;238m‚îÇ[0m [38;2;255;255;255m      [0m[38;2;255;255;255mSHELL[0m[m
[38;5;238m  43[0m   [38;5;238m‚îÇ[0m [38;2;255;255;255m    [0m[38;2;255;255;255mend[0m[m
[38;5;238m  44[0m   [38;5;238m‚îÇ[0m [38;2;255;255;255m  [0m[38;2;255;255;255mend[0m[m
[38;5;238m  45[0m   [38;5;238m‚îÇ[0m [38;2;255;255;255mend[0m[m
[38;5;238m‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[0m[m
[K[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ varga[K[K[Kgrant up
[?2004l[0mBringing machine 'pam' up with 'virtualbox' provider...[0m
[1m==> pam: Importing base box 'generic/centos8s'...[0m
[0m[K[0m[0mProgress: 10%[0m[0m[K[0m[0mProgress: 20%[0m[0m[K[0m[0mProgress: 30%[0m[0m[K[0m[0mProgress: 40%[0m[0m[K[0m[0mProgress: 90%[0m[0m[K[0m[1m==> pam: Matching MAC address for NAT networking...[0m
[1m==> pam: Checking if box 'generic/centos8s' version '4.2.16' is up to date...[0m
[1m==> pam: Setting the name of the VM: 22_pam_1690024329842_6024[0m
[1m==> pam: Clearing any previously set network interfaces...[0m
[1m==> pam: Preparing network interfaces based on configuration...[0m
[0m    pam: Adapter 1: nat[0m
[0m    pam: Adapter 2: hostonly[0m
[1m==> pam: Forwarding ports...[0m
[0m    pam: 22 (guest) => 2222 (host) (adapter 1)[0m
[1m==> pam: Running 'pre-boot' VM customizations...[0m
[1m==> pam: Booting VM...[0m
[1m==> pam: Waiting for machine to boot. This may take a few minutes...[0m
[0m    pam: SSH address: 127.0.0.1:2222[0m
[0m    pam: SSH username: vagrant[0m
[0m    pam: SSH auth method: private key[0m
[0m    pam: 
    pam: Vagrant insecure key detected. Vagrant will automatically replace
    pam: this with a newly generated keypair for better security.[0m
[0m    pam: 
    pam: Inserting generated public key within guest...[0m
[0m    pam: Removing insecure key from the guest if it's present...[0m
[0m    pam: Key inserted! Disconnecting and reconnecting using new SSH key...[0m
[1m==> pam: Machine booted and ready![0m
[1m==> pam: Checking for guest additions in VM...[0m
[0m    pam: The guest additions on this VM do not match the installed version of
    pam: VirtualBox! In most cases this is fine, but in rare cases it can
    pam: prevent things such as shared folders from working properly. If you see
    pam: shared folder errors, please make sure the guest additions within the
    pam: virtual machine match the version of VirtualBox you have installed on
    pam: your host and reload your VM.
    pam: 
    pam: Guest Additions Version: 6.1.30
    pam: VirtualBox Version: 7.0[0m
[1m==> pam: Setting hostname...[0m
[1m==> pam: Configuring and enabling network interfaces...[0m
[1m==> pam: Running provisioner: shell...[0m
[0m    pam: Running: inline script[0m
[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ vagrant ssh
[?2004l[vagrant@pam ~]$ 
[vagrant@pam ~]$ 
[vagrant@pam ~]$ 
[vagrant@pam ~]$ 
[vagrant@pam ~]$ u[Ksudo -i
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# useradd otusadm && useradd otus
[root@pam ~]# echo "Otus2022!" | passwd --stdin otusadm && echo "Otus2022!" | passwd --stdin otus
Changing password for user otusadm.
passwd: all authentication tokens updated successfully.
Changing password for user otus.
passwd: all authentication tokens updated successfully.
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# groupadd -f admin
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# usermod otusadm -a -G admin && usermod root -a -G admin && usermod vagrant -a -G admin
[root@pam ~]# logout
[vagrant@pam ~]$ logout
[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ 
[?2004l[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ 
[?2004l[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ 
[?2004l[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ 
[?2004l[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ [7mssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no otus@192.168.59.10[27m[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no otus@192.168.59.10
[?2004lWarning: Permanently added '192.168.59.10' (RSA) to the list of known hosts.
otus@192.168.59.10's password: 
[otus@pam ~]$ whoami
otus
[otus@pam ~]$ logout
Connection to 192.168.59.10 closed.
[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no otus@192.168.59.10a@192.168.59.10d@192.168.59.10m@192.168.59.10
[?2004lWarning: Permanently added '192.168.59.10' (RSA) to the list of known hosts.
otusadm@192.168.59.10's password: 
[otusadm@pam ~]$ whoami
otusadm
[otusadm@pam ~]$ logout
Connection to 192.168.59.10 closed.
[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ vagrant ssh
[?2004lLast login: Sat Jul 22 11:14:16 2023 from 10.0.2.2
[vagrant@pam ~]$ sudo -io[K
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# cat /etc/group | grep admin
[01;31m[Kadmin[m[K:x:1003:otusadm,root,vagrant
[root@pam ~]# vim /usr/local/bin/login.sh
[?1049h[?1h=[1;69r[27m[24m[23m[0m[H[J[?25l[69;1H"/usr/local/bin/login.sh" [New File][2;1H[94m~                                                                                                                                                                                   [3;1H~                                                                                                                                                                                   [4;1H~                                                                                                                                                                                   [5;1H~                                                                                                                                                                                   [6;1H~                                                                                                                                                                                   [7;1H~                                                                                                                                                                                   [8;1H~                                                                                                                                                                                   [9;1H~                                                                                                                                                                                   [10;1H~                                                                                                                                                                                   [11;1H~                                                                                                                                                                                   [12;1H~                                                                                                                                                                                   [13;1H~                                                                                                                                                                                   [14;1H~                                                                                                                                                                                   [15;1H~                                                                                                                                                                                   [16;1H~                                                                                                                                                                                   [17;1H~                                                                                                                                                                                   [18;1H~                                                                                                                                                                                   [19;1H~                                                                                                                                                                                   [20;1H~                                                                                                                                                                                   [21;1H~                                                                                                                                                                                   [22;1H~                                                                                                                                                                                   [23;1H~                                                                                                                                                                                   [24;1H~                                                                                                                                                                                   [25;1H~                                                                                                                                                                                   [26;1H~                                                                                                                                                                                   [27;1H~                                                                                                                                                                                   [28;1H~                                                                                                                                                                                   [29;1H~                                                                                                                                                                                   [30;1H~                                                                                                                                                                                   [31;1H~                                                                                                                                                                                   [32;1H~                                                                                                                                                                                   [33;1H~                                                                                                                                                                                   [34;1H~                                                                                                                                                                                   [35;1H~                                                                                                                                                                                   [36;1H~                                                                                                                                                                                   [37;1H~                                                                                                                                                                                   [38;1H~                                                                                                                                                                                   [39;1H~                                                                                                                                                                                   [40;1H~                                                                                                                                                                                   [41;1H~                                                                                                                                                                                   [42;1H~                                                                                                                                                                                   [43;1H~                                                                                                                                                                                   [44;1H~                                                                                                                                                                                   [45;1H~                                                                                                                                                                                   [46;1H~                                                                                                                                                                                   [47;1H~                                                                                                                                                                                   [48;1H~                                                                                                                                                                                   [49;1H~                                                                                                                                                                                   [50;1H~                                                                                                                                                                                   [51;1H~                                                                                                                                                                                   [52;1H~                                                                                                                                                                                   [53;1H~                                                                                                                                                                                   [54;1H~                                                                                                                                                                                   [55;1H~                                                                                                                                                                                   [56;1H~                                                                                                                                                                                   [57;1H~                                                                                                                                                                                   [58;1H~                                                                                                                                                                                   [59;1H~                                                                                                                                                                                   [60;1H~                                                                                                                                                                                   [61;1H~                                                                                                                                                                                   [62;1H~                                                                                                                                                                                   [63;1H~                                                                                                                                                                                   [64;1H~                                                                                                                                                                                   [65;1H~                                                                                                                                                                                   [66;1H~                                                                                                                                                                                   [67;1H~                                                                                                                                                                                   [68;1H~                                                                                                                                                                                   [0m[69;163H0,0-1[9CAll[1;1H[34h[?25h[?25l[69;153H:[1;1H[69;1H[K[69;1H:[34h[?25hset paste[?25l[1;1H[34h[?25h[?25l[69;170Hi[1;1H[69;170H [1;1H[69;1H[1m-- INSERT (paste) --[1;1H[34h[?25h[?25l[0m[34m#!/bin/bash
#–~_–µ—~@–≤–æ–µ —~C—~A–ª–æ–≤–∏–µ: –µ—~A–ª–∏ –¥–µ–Ω—~L –Ω–µ–¥–µ–ª–∏ —~A—~C–±–±–æ—~B–∞ –∏–ª–∏ –≤–æ—~A–∫—~@–µ—~A–µ–Ω—~L–µ[0m[2;119H[K[3;1H[38;5;130mif [[0m [35m$([0m[35mdate +%a[0m[35m)[0m [38;5;130m=[0m [31m"Sat"[0m [38;5;130m][0m [38;5;130m||[0m [38;5;130m[[0m [35m$([0m[35mdate +%a[0m[35m)[0m [38;5;130m=[0m [31m"Sun"[0m [38;5;130m];[0m [38;5;130mthen[0m[3;60H[K[4;1H [34m#–~R—~B–æ—~@–æ–µ —~C—~A–ª–æ–≤–∏–µ: –≤—~E–æ–¥–∏—~B –ª–∏ –ø–æ–ª—~L–∑–æ–≤–∞—~B–µ–ª—~L –≤ –≥—~@—~C–ø–ø—~C admin[0m[4;109H[K[5;1H [38;5;130mif [0mgetent group admin [38;5;130m|[0m [38;5;130mgrep[0m [35m-qw[0m [38;5;130m"[0m[35m$PAM_USER[0m[38;5;130m";[0m [38;5;130mthen[0m[5;52H[K[6;1H        [34m#–~U—~A–ª–∏ –ø–æ–ª—~L–∑–æ–≤–∞—~B–µ–ª—~L –≤—~E–æ–¥–∏—~B –≤ –≥—~@—~C–ø–ø—~C admin, —~B–æ –æ–Ω –º–æ–∂–µ—~B –ø–æ–¥–∫–ª—~N—~G–∏—~B—~L—~A—~O[0m[6;143H[K[7;1H        [38;5;130mexit[0m [31m0[0m[7;15H[K[8;1H      [38;5;130melse[0m[8;11H[K[9;1H        [34m#–~X–Ω–∞—~G–µ –æ—~H–∏–±–∫–∞ (–Ω–µ —~A–º–æ–∂–µ—~B –ø–æ–¥–∫–ª—~N—~G–∏—~B—~L—~A—~O)[0m[9;89H[K[10;1H        [38;5;130mexit[0m [31m1[0m[10;15H[K[11;1H    [38;5;130mfi[0m[11;7H[K[12;1H  [34m#–~U—~A–ª–∏ –¥–µ–Ω—~L –Ω–µ –≤—~K—~E–æ–¥–Ω–æ–π, —~B–æ –ø–æ–¥–∫–ª—~N—~G–∏—~B—~L—~A—~O –º–æ–∂–µ—~B –ª—~N–±–æ–π –ø–æ–ª—~L–∑–æ–≤–∞—~B–µ–ª—~L[0m[12;138H[K[13;1H  [38;5;130melse[0m[13;7H[K[14;1H    [38;5;130mexit[0m [31m0[0m[14;11H[K[15;1H[38;5;130mfi[0m[15;3H[K[15;3H[34h[?25h[69;1H[K[15;2H[?25l[69;170H^[[15;2H[69;170H  [15;3H[34h[?25h[?25l[69;170H:[15;2H[69;170H[K[69;1H:[34h[?25hw[?25l"/usr/local/bin/login.sh" [New] 15L, 719C written[15;2H[34h[?25h[?25l[69;170H:[15;2H[69;1H[K[69;1H:[34h[?25hq[?25l[69;1H[K[69;1H[?1l>[34h[?25h[?1049l[root@pam ~]# chmod +x /usr/local/bin/login.sh
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# cp /etc/pam.d/sshd /etc/pam.d/sshd.bak
[root@pam ~]# vim /etc/pam.d/sshd
[?1049h[?1h=[1;69r[27m[24m[23m[0m[H[J[?25l[69;1H"/etc/pam.d/sshd" 17L, 727C[1;1H[34m#%PAM-1.0[0m
[32mauth[0m[7C[35msubstack[0m     [31mpassword-auth[0m
[32mauth[0m[7C[35minclude[0m      [31mpostlogin[0m
[32maccount[0m    [35mrequired[0m     [31mpam_sepermit.so[0m
[32maccount[0m    [35mrequired[0m     [31mpam_nologin.so[0m
[32maccount[0m    [35minclude[0m      [31mpassword-auth[0m
[32mpassword[0m   [35minclude[0m      [31mpassword-auth[0m
[34m# pam_selinux.so close should be the first session rule[0m
[32msession[0m    [35mrequired[0m     [31mpam_selinux.so[0m close
[32msession[0m    [35mrequired[0m     [31mpam_loginuid.so[0m
[34m# pam_selinux.so open should only be followed by sessions to be executed in the user context[0m
[32msession[0m    [35mrequired[0m     [31mpam_selinux.so[0m open env_params
[32msession[0m    [35mrequired[0m     [31mpam_namespace.so[0m
[32msession[0m    [35moptional[0m     [31mpam_keyinit.so[0m force revoke
[32msession[0m    [35moptional[0m     [31mpam_motd.so[0m
[32msession[0m    [35minclude[0m      [31mpassword-auth[0m
[32msession[0m    [35minclude[0m      [31mpostlogin[0m
[94m~                                                                                                                                                                                   [19;1H~                                                                                                                                                                                   [20;1H~                                                                                                                                                                                   [21;1H~                                                                                                                                                                                   [22;1H~                                                                                                                                                                                   [23;1H~                                                                                                                                                                                   [24;1H~                                                                                                                                                                                   [25;1H~                                                                                                                                                                                   [26;1H~                                                                                                                                                                                   [27;1H~                                                                                                                                                                                   [28;1H~                                                                                                                                                                                   [29;1H~                                                                                                                                                                                   [30;1H~                                                                                                                                                                                   [31;1H~                                                                                                                                                                                   [32;1H~                                                                                                                                                                                   [33;1H~                                                                                                                                                                                   [34;1H~                                                                                                                                                                                   [35;1H~                                                                                                                                                                                   [36;1H~                                                                                                                                                                                   [37;1H~                                                                                                                                                                                   [38;1H~                                                                                                                                                                                   [39;1H~                                                                                                                                                                                   [40;1H~                                                                                                                                                                                   [41;1H~                                                                                                                                                                                   [42;1H~                                                                                                                                                                                   [43;1H~                                                                                                                                                                                   [44;1H~                                                                                                                                                                                   [45;1H~                                                                                                                                                                                   [46;1H~                                                                                                                                                                                   [47;1H~                                                                                                                                                                                   [48;1H~                                                                                                                                                                                   [49;1H~                                                                                                                                                                                   [50;1H~                                                                                                                                                                                   [51;1H~                                                                                                                                                                                   [52;1H~                                                                                                                                                                                   [53;1H~                                                                                                                                                                                   [54;1H~                                                                                                                                                                                   [55;1H~                                                                                                                                                                                   [56;1H~                                                                                                                                                                                   [57;1H~                                                                                                                                                                                   [58;1H~                                                                                                                                                                                   [59;1H~                                                                                                                                                                                   [60;1H~                                                                                                                                                                                   [61;1H~                                                                                                                                                                                   [62;1H~                                                                                                                                                                                   [63;1H~                                                                                                                                                                                   [64;1H~                                                                                                                                                                                   [65;1H~                                                                                                                                                                                   [66;1H~                                                                                                                                                                                   [67;1H~                                                                                                                                                                                   [68;1H~                                                                                                                                                                                   [0m[69;163H1,1[11CAll[1;1H[34h[?25h[?25l[69;153HG[1;1H[69;153H [17;1H[69;164H7,1[17;1H[34h[?25h[?25l[69;153Ho[17;1H[69;153H [18;1H[69;1H[1m-- INSERT --[0m[69;13H[K[69;163H18,1[10CAll[18;1H[K[18;1H[34h[?25h[?25l[32mauth[0m [35mrequired[0m [31mpam_exec.so[0m /usr/local/bin/login.sh[69;166H50[18;50H[34h[?25h[69;1H[K[?25l[69;163H18,49[9CAll[18;49H[34h[?25h[?25l[69;153H:[18;49H[69;153H[K[69;1H:[34h[?25hw[?25l"/etc/pam.d/sshd" 18L, 777C written[18;49H[69;163H18,49[9CAll[69;163H[K[69;163H18,49[9CAll[18;49H[34h[?25h[?25l[69;153H:[18;49H[69;1H[K[69;1H:[34h[?25hq[?25l[69;1H[K[69;1H[?1l>[34h[?25h[?1049l[root@pam ~]# systemctl restart sshd
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# 
[root@pam ~]# logout
[vagrant@pam ~]$ logout
[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ 
[?2004l[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ 
[?2004l[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ 
[?2004l[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ 
[?2004l[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ vagrant sshssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no otusadm@192.168.59.10[3P@192.168.59.10
[?2004lWarning: Permanently added '192.168.59.10' (RSA) to the list of known hosts.
otus@192.168.59.10's password: 
Permission denied, please try again.
otus@192.168.59.10's password: 
Permission denied, please try again.
otus@192.168.59.10's password: 

[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no otus@192.168.59.10a@192.168.59.10d@192.168.59.10m@192.168.59.10
[?2004lWarning: Permanently added '192.168.59.10' (RSA) to the list of known hosts.
otusadm@192.168.59.10's password: 
Last login: Sat Jul 22 11:15:33 2023 from 192.168.59.1
[otusadm@pam ~]$ whoami
otusadm
[otusadm@pam ~]$ logout
Connection to 192.168.59.10 closed.
[?2004h[01;32mzoid@npc[00m:[01;34m~/projects/otus/2023-04-linux/22[00m$ [?2004l
exit

Script done on 2023-07-22 14:17:47+03:00 [COMMAND_EXIT_CODE="0"]
